@model  IEnumerable<E4S.Models.HumanResource.Leave>

@{
  ViewData["Title"] = "Leave";
  Layout = "~/Views/Shared/_LayoutEmployee.cshtml";
}

<div class="content">
  <div class="card">
    <div class="card-header text-center" data-background-color="orange">
      <h3 class="card-title">
        Leaves
      </h3>
      <h5 class="description">
        Apply For A New Leave.
      </h5>
    </div>
    @*<h4 class="card-title"> Employee Jobs</h4>*@

    <div class="row">
      <div class="col-md-12">
        <div class="card ">

          <div class="card-body ">

            <!-- Start of the Emergency Contact tabs-->


            <div class="card-header">
              <div class="justify-content-end align-items-center ">
                <a class="btn btn-fill btn-primary" data-toggle="modal" data-target="#noticeModal">Create New</a>
              </div>
            </div>
            <!-- notice modal -->
            <div class="modal fade" id="noticeModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-notice">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                      <i class="now-ui-icons ui-1_simple-remove"></i>
                    </button>
                    <h5 class="modal-title" id="myModalLabel">Enter New Leave</h5>
                  </div>
                  <div class="modal-body">
                    <div class="instruction">
                      <form>
                        @*<div class="row">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label>Employee Name</label>
                              <input id="EmployeeName" name="EmployeeName" type="text" class="form-control" placeholder="Employee Name" required>
                            </div>
                          </div>
                        </div>*@

                        <div class="row">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label>Leave</label>
                              @*<input id="Name" name="Name" type="text" class="form-control" placeholder="Name" required>*@
                            <select id="LeaveTitle" name="LeaveTitle" asp-items="ViewBag.LeaveTitle" class="form-control">

                            </select>
                            </div>
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label>Description</label>
                              <input id="Description" name="Description" type="text" class="form-control" placeholder="Description" required>
                            </div>
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label>Start Date</label>
                              <input id="LeaveStartDate" name="LeaveStartDate" type="date" class="form-control" placeholder="Name" required>
                            </div>
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label>End Date</label>
                              <input id="LeaveEndDate" name="LeaveEndDate" type="date" class="form-control" placeholder="Relationship">
                            </div>
                          </div>
                        </div>
                        

                        <hr />
                        <div class="card-footer ">
                          <button type="button" class="btn btn-fill btn-primary btn-round" id="submitNewLeave">Submit</button>
                          <button type="button" class="btn btn-info btn-round" data-dismiss="modal">Close</button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- end notice modal -->

            <div class="card-body">
              <br />
              <table id="datatable" class="table table-striped " cellspacing="10" width="100%">
                <thead>
                  <tr>
                    <th>Leave</th>
                    <th>Description</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Approved Date</th>
                    <th>Status</th>

                    <th class="disabled-sorting text-right">Actions</th>
                  </tr>
                </thead>
                
                <tbody>

                  @foreach (var item in Model)
                  {
                  <tr>
                    <td>@item.LeaveTitle</td>
                    <td>@item.Description</td>
                    <td>@item.StartDate.ToString("MMMM dd, yyyy")</td>
                    <td>@item.EndDate.ToString("MMMM dd, yyyy")</td>
                    <td>@item.ApproveDate.ToString("MMMM dd, yyyy")</td>
                    <td>@item.Status</td>
                    <td class="text-right">
                      <a href="#" class="btn btn-round btn-warning btn-icon btn-sm edit"><i class="far fa-calendar-alt"></i></a>
                      <a href="#" class="btn btn-round btn-danger btn-icon btn-sm remove"><i class="fas fa-times"></i></a>
                    </td>
                  </tr>

                  }

                </tbody>
              </table>
            </div>
            <!-- the End of Emergency Contact Tabs-->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



@section Scripts {


  <script type="text/javascript">

    $(document).ready(function () {

      $("#submitNewLeave").click(function (event) {

        event.preventDefault();

        var NewLeave = {
          LeaveTitle: $("#LeaveTitle").val(),
          Description: $("#Description").val(),
          StartDate: $("#LeaveStartDate").val(),
          EndDate: $("#LeaveEndDate").val(),
        };


        // console.log(Items);
        console.log(NewLeave);

        $.ajax({
          type: "POST",
          url: "/EmployeeProfile/PostNewLeave",
          data: JSON.stringify(NewLeave),
          dataType: "json",
          contentType: 'application/json; charset=utf-8',
          headers: {
            RequestVerificationToken:
              $('input:hidden[name="__RequestVerificationToken"]').val()
          },
          success: function (r) {

            if (r.msg == "Success") {

              demo.showSwal('success-message');

            } else if (r.msg == "Fail") {

              alert(r.msg);

            } else if (r.msg == "No Data") {
              alert(r.msg);

            } else {
              alert(r.msg);
            }
            //alert(r.msg);
            // window.location.reload();

          },
          error: function () {
            alert(r.msg);
          }
        });
      });


    });

  </script>

}

